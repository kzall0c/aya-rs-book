package main

import (
    "log"
    "net"
    "github.com/ishidawataru/sctp"
)

func main() {
    // SCTP 서버 주소 (NGAP 대상 서버 IP, 포트)
    remoteAddr := &sctp.SCTPAddr{
        IPAddrs: []net.IPAddr{{IP: net.ParseIP("192.168.67.15")}}, // 변경 필요
        Port:    38412,                                        // NGAP SCTP 포트
    }

    // 로컬 주소 (nil: OS가 자동 할당)
    localAddr := &sctp.SCTPAddr{}

    // SCTP 연결 생성
    conn, err := sctp.DialSCTP("sctp", localAddr, remoteAddr)
    if err != nil {
        log.Fatalf("SCTP dial error: %v", err)
    }
    defer conn.Close()

    log.Println("SCTP connection established")

    // NGAP 페이로드 바이너리 예시 (여기에 실제 NGAP 패킷 넣어야 함)
    ngapPayload := []byte{
        0x00, 0x15, 0x00, 0x50, 0x00, 0x00, 0x04, 0x00,
        0x1b, 0x00, 0x08, 0x40, 0x21, 0x43, 0x65, 0x40,
        0x00, 0x00, 0x40, 0x00, 0x52, 0x40, 0x1d, 0x0d,
        0x00, 0x67, 0x4e, 0x6f, 0x64, 0x65, 0x42, 0x5f,
        0x64, 0x79, 0x6e, 0x61, 0x6d, 0x69, 0x63, 0x5f,
        0x75, 0x6c, 0x74, 0x72, 0x61, 0x5f, 0x6d, 0x61,
        0x78, 0x5f, 0x37, 0x37, 0x00, 0x66, 0x00, 0x17,
        0x00, 0x00, 0x00, 0x00, 0x0c, 0x00, 0x21, 0x43,
        0x65, 0x00, 0x02, 0x10, 0x08, 0x00, 0x00, 0x01,
        0x10, 0x08, 0x00, 0x00, 0x02, 0x00, 0x10, 0x00,
        0x15, 0x40, 0x01, 0x20,
    }

    // 페이로드 SCTP로 전송
    n, err := conn.Write(ngapPayload)
    if err != nil {
        log.Fatalf("Failed to send NGAP payload: %v", err)
    }

    log.Printf("Sent %d bytes NGAP payload\n", n)
}

